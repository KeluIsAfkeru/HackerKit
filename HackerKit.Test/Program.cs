using HackerKit.Models;
using HackerKit.Views;
using HackerKit.Services;

/*测试解码*/
Console.WriteLine("\r\n------------------");
Console.WriteLine("测试解码");
Console.WriteLine("------------------");
var decode_hexStr = "1214E59BBEE59BBEE598BFE7A781F09F949E2E7A69703A8A011287013A1C7B22686569676874223A313032342C227769647468223A313032347D422033443744424538374138323637443039443745333745363631323837384244462214E59BBEE59BBEE598BFE7A781F09F949E2E7A6970280018D2EFCACCAA030866122439383032356238352D373737612D343631312D393039352D38643464323332636131386208061A053142797465";
var decode_hexStr_head = "2AFA05081812DE0230313030414331323134453539424245453539424245453539384246453741373831463039463934394532453741363937303341384130313132383730313341314337423232363836353639363736383734323233413331333033323334324332323737363936343734363832323341333133303332333437443432323033333434333734343432343533383337343133383332333633373434333033393434333734353333333734353336333633313332333833373338343234343436323231344535394242454535394242454535393842464537413738314630394639343945324537413639373032383030313844324546434143434141303330383636313232343339333833303332333536323338333532443337333733373631324433343336333133313244333933303339333532443338363433343634333233333332363336313331333836323038303631413035333134323739373436351A94030A0CE69EABE58FB6E598BFE5A3B31001100010AC011012101410E501109B0110BE0110E501109B0110BE0110E50110980110BF0110E70110A70110810110F001109F01109401109E01102E107A10691070103A108A01100110121087011001103A101C107B10221068106510691067106810741022103A1031103010321034102C1022107710691064107410681022103A1031103010321034107D10421020103310441037104410421045103810371041103810321036103710441030103910441037104510331037104510361036103110321038103710381042104410461022101410E501109B0110BE0110E501109B0110BE0110E50110980110BF0110E70110A70110810110F001109F01109401109E01102E107A1069107010281000101810D20110EF0110CA0110CC0110AA011003100810661012102410391038103010321035106210381035102D1037103710371061102D1034103610311031102D1039103010391035102D10381064103410641032103310321063106110311038106210081006101A100510311042107910741065";
var decode_bytes = BytesService.ParseHexWithSpaces(decode_hexStr);
var decode_bytes_head = BytesService.ParseHexWithSpaces(decode_hexStr_head);
var decode_proto = ProtobufService.Decode(decode_bytes);
var decode_json = decode_proto?.pbJson;
var decode_proto_head = ProtobufService.TryParseWithHead(decode_bytes_head);
var decode_json_head = decode_proto_head?.pbJson;
var decode_proto_head_all = ProtobufService.DeepParseHexProtos(decode_proto_head);
var decode_json_head_all = decode_proto_head_all?.pbJson;

Console.WriteLine($"【解码后未暴力穷举的json】：{decode_json}-------head：{BytesService.BytesToHex(decode_proto.Head)}\n");
Console.WriteLine($"【解码带head的proto】：{decode_json_head}------head：{BytesService.BytesToHex(decode_proto_head.Head)}\n");
Console.WriteLine($"【完全展开解码带head的proto】：{decode_json_head_all}------head：{BytesService.BytesToHex(decode_proto_head_all.Head)}\n");

/*测试编码*/
Console.WriteLine("\r\n------------------");
Console.WriteLine("测试编码");
Console.WriteLine("------------------");

var encode_protoStr = "{\r\n\t\"5\": {\r\n\t\t\"1\": 24,\r\n\t\t\"2\": \"hex->0100AC1214E59BBEE59BBEE598BFE7A781F09F949E2E7A69703A8A011287013A1C7B22686569676874223A313032342C227769647468223A313032347D422033443744424538374138323637443039443745333745363631323837384244462214E59BBEE59BBEE598BFE7A781F09F949E2E7A6970280018D2EFCACCAA030866122439383032356238352D373737612D343631312D393039352D38643464323332636131386208061A053142797465\",\r\n\t\t\"3\": {\r\n\t\t\t\"1\": \"枫叶嘿壳\",\r\n\t\t\t\"2\": \"hex->0100AC1214E59BBEE59BBEE598BFE7A781F09F949E2E7A69703A8A011287013A1C7B22686569676874223A313032342C227769647468223A313032347D422033443744424538374138323637443039443745333745363631323837384244462214E59BBEE59BBEE598BFE7A781F09F949E2E7A6970280018D2EFCACCAA030866122439383032356238352D373737612D343631312D393039352D38643464323332636131386208061A053142797465\"\r\n\t\t}\r\n\t}\r\n}";
var encode_proto = ProtobufService.FromJson(encode_protoStr);
var encode_hex = encode_proto.ToHex();

Console.WriteLine($"【编码后的Protocal Buffer】：{encode_hex}\n");

Console.ReadLine();
